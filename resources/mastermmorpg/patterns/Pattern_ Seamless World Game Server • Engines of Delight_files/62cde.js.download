(function($){var jprp={response:null,getEndpointURL:function(URL){var locationObject,is_customizer='undefined'!==typeof wp&&wp.customize&&wp.customize.settings&&wp.customize.settings.url&&wp.customize.settings.url.self;if(is_customizer){locationObject=document.createElement('a');locationObject.href=wp.customize.settings.url.self;}else{locationObject=document.location;}
if('string'===typeof(URL)&&URL.match(/^https?:\/\//)){locationObject=document.createElement('a');locationObject.href=URL;}
var args='relatedposts=1';if($('#jp-relatedposts').data('exclude')){args+='&relatedposts_exclude='+$('#jp-relatedposts').data('exclude');}
if(is_customizer){args+='&jetpackrpcustomize=1';}
var pathname=locationObject.pathname;if('/'!==pathname[0]){pathname='/'+pathname;}
if(''===locationObject.search){return pathname+'?'+args;}else{return pathname+locationObject.search+'&'+args;}},getAnchor:function(post,classNames){var anchor_title=post.title;if(''!==(''+post.excerpt)){anchor_title+='\n\n'+post.excerpt;}
var anchor=$('<a>');anchor.attr({'class':classNames,'href':post.url,'title':anchor_title,'rel':post.rel,'data-origin':post.url_meta.origin,'data-position':post.url_meta.position});var anchor_html=$('<div>').append(anchor).html();return[anchor_html.substring(0,anchor_html.length-4),'</a>'];},generateMinimalHtml:function(posts,options){var self=this;var html='';$.each(posts,function(index,post){var anchor=self.getAnchor(post,'jp-relatedposts-post-a');var classes='jp-relatedposts-post jp-relatedposts-post'+index;if(post.classes.length>0){classes+=' '+post.classes.join(' ');}
html+='<p class="'+classes+'" data-post-id="'+post.id+'" data-post-format="'+post.format+'">';html+='<span class="jp-relatedposts-post-title">'+anchor[0]+post.title+anchor[1]+'</span>';if(options.showDate){html+='<span class="jp-relatedposts-post-date">'+post.date+'</span>';}
if(options.showContext){html+='<span class="jp-relatedposts-post-context">'+post.context+'</span>';}
html+='</p>';});return'<div class="jp-relatedposts-items jp-relatedposts-items-minimal jp-relatedposts-'+options.layout+' ">'+html+'</div>';},generateVisualHtml:function(posts,options){var self=this;var html='';$.each(posts,function(index,post){var anchor=self.getAnchor(post,'jp-relatedposts-post-a');var classes='jp-relatedposts-post jp-relatedposts-post'+index;if(post.classes.length>0){classes+=' '+post.classes.join(' ');}
if(!post.img.src){classes+=' jp-relatedposts-post-nothumbs';}else{classes+=' jp-relatedposts-post-thumbs';}
html+='<div class="'+classes+'" data-post-id="'+post.id+'" data-post-format="'+post.format+'">';if(post.img.src){html+=anchor[0]+'<img class="jp-relatedposts-post-img" src="'+post.img.src+'" width="'+post.img.width+'" alt="'+post.title+'" />'+anchor[1];}else{var anchor_overlay=self.getAnchor(post,'jp-relatedposts-post-a jp-relatedposts-post-aoverlay');html+=anchor_overlay[0]+anchor_overlay[1];}
html+='<'+related_posts_js_options.post_heading+' class="jp-relatedposts-post-title">'+anchor[0]+post.title+anchor[1]+'</'+related_posts_js_options.post_heading+'>';html+='<p class="jp-relatedposts-post-excerpt">'+$('<p>').text(post.excerpt).html()+'</p>';if(options.showDate){html+='<p class="jp-relatedposts-post-date">'+post.date+'</p>';}
if(options.showContext){html+='<p class="jp-relatedposts-post-context">'+post.context+'</p>';}
html+='</div>';});return'<div class="jp-relatedposts-items jp-relatedposts-items-visual jp-relatedposts-'+options.layout+' ">'+html+'</div>';},setVisualExcerptHeights:function(){var elements=$('#jp-relatedposts .jp-relatedposts-post-nothumbs .jp-relatedposts-post-excerpt');if(0>=elements.length){return;}
var fontSize=parseInt(elements.first().css('font-size'),10),lineHeight=parseInt(elements.first().css('line-height'),10);elements.css('max-height',(5*lineHeight/fontSize)+'em');},getTrackedUrl:function(anchor){var args='relatedposts_hit=1';args+='&relatedposts_origin='+$(anchor).data('origin');args+='&relatedposts_position='+$(anchor).data('position');var pathname=anchor.pathname;if('/'!==pathname[0]){pathname='/'+pathname;}
if(''===anchor.search){return pathname+'?'+args;}else{return pathname+anchor.search+'&'+args;}},cleanupTrackedUrl:function(){if('function'!==typeof history.replaceState){return;}
var cleaned_search=document.location.search.replace(/\brelatedposts_[a-z]+=[0-9]*&?\b/gi,'');if('?'===cleaned_search){cleaned_search='';}
if(document.location.search!==cleaned_search){history.replaceState({},document.title,document.location.pathname+cleaned_search);}}};function startRelatedPosts(){jprp.cleanupTrackedUrl();var endpointURL=jprp.getEndpointURL(),$relatedPosts=$('#jp-relatedposts');$.getJSON(endpointURL,function(response){if(0===response.items.length||0===$relatedPosts.length){return;}
jprp.response=response;var html,showThumbnails,options={};if('undefined'!==typeof wp&&wp.customize){showThumbnails=wp.customize.instance('jetpack_relatedposts[show_thumbnails]').get();options.showDate=wp.customize.instance('jetpack_relatedposts[show_date]').get();options.showContext=wp.customize.instance('jetpack_relatedposts[show_context]').get();options.layout=wp.customize.instance('jetpack_relatedposts[layout]').get();}else{showThumbnails=response.show_thumbnails;options.showDate=response.show_date;options.showContext=response.show_context;options.layout=response.layout;}
html=!showThumbnails?jprp.generateMinimalHtml(response.items,options):jprp.generateVisualHtml(response.items,options);$relatedPosts.append(html);jprp.setVisualExcerptHeights();if(options.showDate){$relatedPosts.find('.jp-relatedposts-post-date').show();}
$relatedPosts.show();$('#jp-relatedposts a.jp-relatedposts-post-a').click(function(){this.href=jprp.getTrackedUrl(this);});});}
$(function(){if('undefined'!==typeof wp&&wp.customize){if(wp.customize.selectiveRefresh){wp.customize.selectiveRefresh.bind('partial-content-rendered',function(placement){if('jetpack_relatedposts'===placement.partial.id){startRelatedPosts();}});}
wp.customize.bind('preview-ready',startRelatedPosts);}else{startRelatedPosts();}});})(jQuery);
;/* Modernizr 2.8.3 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-touch-teststyles-prefixes
 */
if(typeof CM_Tools === 'undefined')
{
    CM_Tools = {};
}
;CM_Tools.Modernizr=function(a,b,c){function v(a){i.cssText=a}function w(a,b){return v(l.join(a+";")+(b||""))}function x(a,b){return typeof a===b}function y(a,b){return!!~(""+a).indexOf(b)}function z(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:x(f,"function")?f.bind(d||b):f}return!1}var d="2.8.3",e={},f=b.documentElement,g="modernizr",h=b.createElement(g),i=h.style,j,k={}.toString,l=" -webkit- -moz- -o- -ms- ".split(" "),m={},n={},o={},p=[],q=p.slice,r,s=function(a,c,d,e){var h,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:g+(d+1),l.appendChild(j);return h=["&#173;",'<style id="s',g,'">',a,"</style>"].join(""),l.id=g,(m?l:n).innerHTML+=h,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=f.style.overflow,f.style.overflow="hidden",f.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),f.style.overflow=k),!!i},t={}.hasOwnProperty,u;!x(t,"undefined")&&!x(t.call,"undefined")?u=function(a,b){return t.call(a,b)}:u=function(a,b){return b in a&&x(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=q.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(q.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(q.call(arguments)))};return e}),m.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:s(["@media (",l.join("touch-enabled),("),g,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=a.offsetTop===9}),c};for(var A in m)u(m,A)&&(r=A.toLowerCase(),e[r]=m[A](),p.push((e[r]?"":"no-")+r));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)u(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof enableClasses!="undefined"&&enableClasses&&(f.className+=" "+(b?"":"no-")+a),e[a]=b}return e},v(""),h=j=null,e._version=d,e._prefixes=l,e.testStyles=s,e}(this,this.document);